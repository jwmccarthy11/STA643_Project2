"0","lhs <- function(m, n, r) {"
"0","  # generate the Latin hypercube"
"0","  l <- (-(n - 1)/2):((n - 1)/2)"
"0","  L <- matrix(NA, nrow=n, ncol=m)"
"0","  for(j in 1:m) L[,j] <- sample(l, n)"
"0",""
"0","  # draw the random uniforms and turn the hypercube into a sample"
"0","  U <- matrix(runif(n*m), ncol=m)"
"0","  X <- (L + (n - 1)/2 + U)/n"
"0","  "
"0","  # map to valid input ranges"
"0","  X <- X*rep(r[2,]-r[1,], each=n) + rep(r[1,], each=n)"
"0","  colnames(X) <- colnames(r)"
"0",""
"0","  # return the design"
"0","  # return(list(X=X, g=c((l + (n - 1)/2)/n,1)))"
"0","  return(X)"
"0","}"
