"0","criterion <- function(X) {"
"0","  d <- distance(X)"
"0","  d <- d[upper.tri(d)]"
"0","  min(d)"
"0","}"
"0",""
"0","maximin <- function(m, n, r, T=100000)"
"0","{"
"0","  X <- lhs(m, n, r)     ## initial design"
"0","  md <- criterion(X)"
"0",""
"0","  for(t in 1:T) {"
"0","    # select random column and pair of rows"
"0","    rows <- sample(1:n, 2)"
"0","    col <- sample(1:m, 1)"
"0","    xold <- X[rows,col]"
"0","    "
"0","    # swap values in row pair"
"0","    X[rows,col] <- X[rev(rows),col]"
"0","    "
"0","    # keep better arrangement"
"0","    mdprime <- criterion(X)"
"0","    if(mdprime > md) { "
"0","      md <- mdprime                   ## accept"
"0","    } else { "
"0","      X[rows,col] <- xold             ## reject"
"0","    }"
"0","  }"
"0",""
"0","  return(X)"
"0","}"
